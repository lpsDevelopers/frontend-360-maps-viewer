<div class="orbit-modal">
  <div class="header-actions">
    <h2>Agregar Postes</h2>
    <button class="close-btn" (click)="closeHideOrbitCard()">√ó</button>
  </div>

  <div class="modal-header">
    <div class="csv-import-container"
         (drop)="onFileDrop($event)"
         (dragover)="onDragOver($event)">
      <p>Arrastra y suelta un archivo CSV o Excel aqu√≠</p>
      <label class="upload-btn">
        Seleccionar archivo
        <input type="file"
               (change)="onFileChange($event)"
               accept=".csv,.xlsx,.xls" />
      </label>
    </div>
  </div>

  <div class="modal-content scroll-wrapper">
    <!-- Mostrar mensaje cuando no hay datos -->
    <div class="no-data-message" *ngIf="filters.length === 0">
      <p>No hay registros cargados. Sube un archivo CSV o Excel para comenzar.</p>
    </div>

    <!-- Tabla de datos -->
    <div class="data-table" *ngIf="filters.length > 0">
      <div class="table-header">
        <div class="col" *ngFor="let header of columnHeaders">
          {{ header }}
        </div>
        <div class="col">Acciones</div>
      </div>

      <div class="table-row" *ngFor="let row of filters; let i = index">
        <div class="col" *ngFor="let header of columnHeaders">
          <input
            class="input-field"
            [(ngModel)]="row[header]"
            [placeholder]="header"
            [class.required]="isRequiredField(header)"
            [class.error]="isFieldEmpty(row[header]) && isRequiredField(header)" />
        </div>
        <div class="col">
          <button class="delete-btn" (click)="removeFilter(i)" title="Eliminar registro">
            üóëÔ∏è
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button class="add-btn" (click)="addFilter()" title="Agregar nuevo registro">
      + Agregar Fila
    </button>

    <div class="footer-actions">
      <!-- Mostrar conteo de registros -->
      <p class="record-count" *ngIf="filters.length > 0">
        {{ filters.length }} registro(s) cargado(s)
      </p>

      <!-- Mensaje de error -->
      <p class="error-message" *ngIf="showErrorMessage">{{ errorMessage }}</p>

      <!-- Bot√≥n para guardar -->
      <button class="apply-btn"
              (click)="addPostesInDataBase()"
              [disabled]="filters.length === 0">
        Registrar Postes en Base de Datos
      </button>
    </div>
  </div>

  <!-- Modal de guardar configuraci√≥n -->
  <div class="save-config-modal" *ngIf="showSaveConfigModal">
    <div class="save-modal-content">
      <div class="save-modal-header">
        <h3>Guardar Configuraci√≥n</h3>
        <button class="close-btn" (click)="showSaveConfigModal = false">√ó</button>
      </div>
      <div class="save-modal-body">
        <div class="form-group">
          <label>Nombre de la configuraci√≥n:</label>
          <input type="text"
                 [(ngModel)]="configurationName"
                 placeholder="Ingrese un nombre"
                 class="input-field"
                 (keyup.enter)="saveConfiguration()">
        </div>
      </div>
      <div class="save-modal-footer">
        <button class="cancel-btn" (click)="showSaveConfigModal = false">
          Cancelar
        </button>
        <button class="confirm-btn"
                (click)="saveConfiguration()"
                [disabled]="!configurationName.trim()">
          Registrar
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de √©xito -->
  <div class="save-config-modal" *ngIf="showSuccessModal">
    <div class="save-modal-content">
      <div class="save-modal-header">
        <h3>‚úÖ Postes Registrados</h3>
        <button class="close-btn" (click)="showSuccessModal = false">√ó</button>
      </div>
      <div class="save-modal-body">
        <p>Todos los postes han sido registrados correctamente en la base de datos.</p>
      </div>
      <div class="save-modal-footer">
        <button class="confirm-btn" (click)="closeModalAndReset()">Cerrar</button>
      </div>
    </div>
  </div>
</div>
